<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>E pro Dashboard</title>

  <!-- vWorld WebGL (3.0) -->
  <script
    type="text/javascript"
    src="https://map.vworld.kr/js/webglMapInit.js.do?version=3.0&apiKey=3907B382-CD3D-304B-A82F-C7BFA4286232">
  </script>

  <!-- ë„ˆ ì›ë˜ CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style_dash.css') }}?v=3">

  <style>
    :root {
      --sidebar-width: 260px;      /* í¼ì³ì¡Œì„ ë•Œ */
      --sidebar-mini: 70px;        /* ì ‘í˜”ì„ ë•Œ ì•„ì´ì½˜ë§Œ ë‚¨ëŠ” í­ */
      --toggle-size: 40px;
      --toggle-gap: 14px;
    }

    /* ì‚¬ì´ë“œë°” ê¸°ë³¸ */
    .sidebar {
      position: fixed;
      top: 0;
      left: 0;
      width: var(--sidebar-width);
      height: 100vh;
      z-index: 1000;
      transition: width .25s ease, transform .25s ease;
      background: #e0ecd9; /* ë„¤ ìŠ¤ìƒ·ì´ë‘ ë¹„ìŠ·í•œ ìƒ‰ìœ¼ë¡œ */
      overflow: hidden;    /* ì¶•ì†Œ ì‹œ ë‚´ìš© ì•ˆ íŠ€ì–´ë‚˜ì˜¤ê²Œ */
    }

    /* ì‚¬ì´ë“œë°” ì•ˆ ë‚´ìš© ì—¬ìœ  */
    .sidebar-body {
      padding: 54px 16px 16px 16px; /* ìœ„ì— ë²„íŠ¼ ìë¦¬ 54px */
    }

    /* ë©”ì¸: ê¸°ë³¸ì€ ì‚¬ì´ë“œë°” í­ë§Œí¼ ë°€ë ¤ìˆìŒ */
    .main {
      margin-left: var(--sidebar-width);
      transition: margin-left .25s ease;
    }

    /* ì ‘íŒ ìƒíƒœ */
    body.sidebar-collapsed .sidebar {
      width: var(--sidebar-mini);
    }
    body.sidebar-collapsed .main {
      margin-left: var(--sidebar-mini);
    }

    /* ë©”ë‰´ ì•„ì´í…œ êµ¬ì¡°í™” */
    .menu .menu-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 8px;
      border-radius: 8px;
      cursor: pointer;
      transition: background .15s ease;
    }
    .menu .menu-item:hover {
      background: rgba(255,255,255,0.4);
    }
    .menu .menu-icon {
      width: 24px;
      height: 24px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
    }
    .menu .menu-label {
      white-space: nowrap;
    }

    /* ì ‘íˆë©´ ê¸€ìë§Œ ìˆ¨ê²¨ */
    body.sidebar-collapsed .menu .menu-label {
      display: none;
    }
    /* ì ‘íˆë©´ ì•ˆìª½ paddingë„ ì¡°ê¸ˆ ì¤„ì´ì */
    body.sidebar-collapsed .sidebar-body {
      padding: 54px 8px 16px 8px;
    }
    body.sidebar-collapsed .search-box {
      display: none; /* ì¢ì€ ìƒíƒœì—ì„œëŠ” ê²€ìƒ‰ì°½ ìˆ¨ê¹€ */
    }

    /* ê³ ì • í–„ë²„ê±° ë²„íŠ¼ â€“ ì‚¬ì´ë“œë°” ì˜¤ë¥¸ìª½ ìœ„ì— ë”± ë¶™ì–´ìˆê²Œ */
    .sidebar-toggle-btn {
      position: fixed;
      top: var(--toggle-gap);
      left: calc(var(--sidebar-width) - var(--toggle-size) - var(--toggle-gap));
      width: var(--toggle-size);
      height: 32px;
      background: #e6f0e1;
      border: 1px solid #c3d3bd;
      border-radius: 10px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 4px;
      padding: 4px 7px;
      cursor: pointer;
      z-index: 2000;
      box-shadow: 0 1px 2px rgba(0,0,0,0.04);
      transition: left .25s ease;
    }
    .sidebar-toggle-btn span {
      display: block;
      height: 3px;
      background: #324b33;
      border-radius: 3px;
    }
    .sidebar-toggle-btn:hover {
      background: #d7e7d0;
    }

    /* ì ‘í˜”ì„ ë•ŒëŠ” ë²„íŠ¼ë„ ì•„ì´ì½˜ ë ˆì¼ ìœ„ì— ë‚¨ê²Œ */
    body.sidebar-collapsed .sidebar-toggle-btn {
      left: calc(var(--sidebar-mini) - var(--toggle-size) - 6px);
    }
  </style>
</head>
<body>
  <!-- ì‚¬ì´ë“œë°” -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-body">
      <a href=""><h2 style="margin-bottom: 14px;">E pro</h2></a>


      <nav class="menu">
        <a href="Epro_map.html">
          <div class="menu-item">
            <span class="menu-icon">ğŸŒ</span>
            <span class="menu-label">ì§€ë„ë³´ê¸°</span>
          </div>
        </a>
        <a href="Epro.html">
          <div class="menu-item">
            <span class="menu-icon">ğŸ“</span>
            <span class="menu-label">ëŒ€ì‹œë³´ë“œ</span>
          </div>
        </a>
        <a href="Epro_graph.html">
          <div class="menu-item">
            <span class="menu-icon">ğŸ“ˆ</span>
            <span class="menu-label">ê·¸ë˜í”„</span>
          </div>
        </a>
        <div class="menu-item">
            <span class="menu-icon">ğŸ’¬</span>
            <span class="menu-label">í•­ëª©1</span>
        </div>
        <div class="menu-item">
            <span class="menu-icon">ğŸ§©</span>
            <span class="menu-label">í•­ëª©2</span>
        </div>
        <a href="Epro_0G.html">
          <div class="menu-item">
            <span class="menu-icon">ğŸ“¢</span>
            <span class="menu-label">ê³µì§€ì‚¬í•­</span>
          </div>
        </a>
        <div class="menu-item">
            <span class="menu-icon">ğŸ‘¥</span>
            <span class="menu-label">ìƒì„¸ì„¤ëª…</span>
        </div>
      </nav>
    </div>
  </aside>

  <!-- ì‚¬ì´ë“œë°” í† ê¸€ ë²„íŠ¼ -->
  <button type="button" class="sidebar-toggle-btn" id="sidebarToggle">
    <span></span>
    <span></span>
    <span></span>
  </button>

  <!-- ë©”ì¸ -->
  <main class="main">
    <div class="main-layout">
      <div class="placeholder">
        <!-- ì§€ë„ -->
        <div id="vmap" style="width:100%; height:100%; min-height:500px;"></div>

        <!-- ì§€ë„ ì•ˆìª½ ì •ë³´ ì‚¬ì´ë“œë°” (ë„ˆ ì›ë˜ ìˆë˜ ê±°) -->
        <div id="mapSidebar" class="map-sidebar">
          <div class="map-sidebar-header">
            <h3>ğŸ¢ ê±´ë¬¼ ì •ë³´</h3>
          </div>

          <div class="map-sidebar-content">
            <div class="map-search">
              <h4>ğŸ” ì£¼ì†Œ ê²€ìƒ‰</h4>
              <div class="map-search-controls">
                <input type="text" id="mapSearchInput" placeholder="ë„ë¡œëª… ë˜ëŠ” ì§€ë²ˆì„ ì…ë ¥í•˜ì„¸ìš”" />
                <button id="mapSearchBtn" class="map-search-btn">ê²€ìƒ‰</button>
              </div>
              <p class="map-search-helper">ê²€ìƒ‰ í›„ ì§€ë„ë¥¼ ì´ë™í•˜ë©´ ìƒë‹¨ ì¹´ë©”ë¼ê°€ í•´ë‹¹ ìœ„ì¹˜ë¡œ ì´ë™í•©ë‹ˆë‹¤.</p>
            </div>

            <div class="info-section">
              <label>ğŸ“ ë„ë¡œëª…ì£¼ì†Œ</label>
              <div class="info-value" id="sidebar_address">ê±´ë¬¼ì„ í´ë¦­í•´ì£¼ì„¸ìš”</div>
            </div>

            <div class="info-section">
              <label>â° ë…¸í›„ë„</label>
              <div class="info-value highlight" id="sidebar_age">-</div>
            </div>

            <div class="info-section">
              <label>ğŸ·ï¸ ê³ ìœ ID</label>
              <div class="info-value" id="sidebar_id">-</div>
            </div>

            <div class="divider"></div>

            <div class="info-section">
              <label>ğŸ—ï¸ ê±´ë¬¼ìš©ë„</label>
              <div class="info-value" id="sidebar_purpose">-</div>
            </div>

            <div class="info-section">
              <label>ğŸŒ ì¢Œí‘œ</label>
              <div class="info-value" id="sidebar_coords">-</div>
            </div>
          </div>
        </div>

        <!-- ì§€ë„ ì•ˆìª½ ì‚¬ì´ë“œë°” í† ê¸€ ë²„íŠ¼ -->
        <button id="toggleMapSidebar" class="map-sidebar-toggle">
          <span class="arrow">â–¶</span>
        </button>

        <!-- íŒì—… -->
        <div id="mapPopup" class="map-popup hidden" role="dialog" aria-live="polite">
          <button type="button" id="mapPopupClose" class="map-popup-close" aria-label="ë‹«ê¸°">Ã—</button>
          <h4 id="popupTitle" class="map-popup-title">ê±´ë¬¼ ì •ë³´</h4>
          <dl class="map-popup-list">
            <div class="map-popup-item">
              <dt>ì „ì²´ ì£¼ì†Œ</dt>
              <dd id="popupFullAddress">ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</dd>
            </div>
            <div class="map-popup-item">
              <dt>ì‹œ/ë„</dt>
              <dd id="popupLevel1">-</dd>
            </div>
            <div class="map-popup-item">
              <dt>ì‹œ/êµ°/êµ¬</dt>
              <dd id="popupLevel2">-</dd>
            </div>
            <div class="map-popup-item">
              <dt>ì/ë©´/ë™</dt>
              <dd id="popupLevel3">-</dd>
            </div>
            <div class="map-popup-item">
              <dt>ë„ë¡œëª…</dt>
              <dd id="popupRoad">-</dd>
            </div>
            <div class="map-popup-item">
              <dt>ê±´ë¬¼ë²ˆí˜¸</dt>
              <dd id="popupBuildingNo">-</dd>
            </div>
            <div class="map-popup-item">
              <dt>ìƒì„¸</dt>
              <dd id="popupDetail">-</dd>
            </div>
          </dl>
        </div>
      </div>
    </div>
  </main>

  <!-- ê¸°ì¡´ js -->
  <script src="{{ url_for('static', filename='script.js') }}?v=4"></script>

  <!-- ê²€ìƒ‰ + ì‚¬ì´ë“œë°” í† ê¸€ -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const toggleBtn = document.getElementById('sidebarToggle');
      if (!toggleBtn) return;

      toggleBtn.addEventListener('click', () => {
        document.body.classList.toggle('sidebar-collapsed');

        if (window.map && typeof window.map.updateSize === 'function') {
          setTimeout(() => window.map.updateSize(), 270);
        }
      });
    });
  </script>
</body>
</html>
